#!/bin/bash

# Print the logo
print_logo() {
    cat << "EOF"
    ______                _ __    __     
   / ____/______  _______(_) /_  / /__   
  / /   / ___/ / / / ___/ / __ \/ / _ \  
 / /___/ /  / /_/ / /__/ / /_/ / /  __/  Arch Linux System Crafting Tool
 \____/_/   \__,_/\___/_/_.___/_/\___/   by: typecraft

EOF
}


# Clear screen and show logo
clear
print_logo

# Exit on any error
set -e

# Source utility functions
source utils.sh

# Source the package list
if [ ! -f "pkgs.conf" ]; then
  echo "Error: pkgs.conf not found!"
  exit 1
fi

source pkgs.conf

# Update the system first
echo "Updating system..."
sudo pacman -Syu --noconfirm

# Install yay AUR helper if not present
if ! command -v yay &> /dev/null; then
  echo "Installing yay AUR helper..."
  sudo pacman -S --needed git base-devel --noconfirm
  if [[ ! -d "yay" ]]; then
    echo "Cloning yay repository..."
  else
    echo "yay directory already exists, removing it..."
    rm -rf yay go
  fi

  git clone https://aur.archlinux.org/yay.git

  cd yay
  echo "building yay.... yaaaaayyyyy"
  makepkg -si --noconfirm
  cd ..
  rm -rf yay go
else
  echo "yay is already installed"
fi


# Install packages

echo "install apps ..."

install_packages_pacman "${PACMAN[@]}"
install_packages_yay "${AUR[@]}"

echo ""
echo "finish"
echo ""
echo "
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠁⣌⣉⠛⢻⣿⣿⣿⣿⣿⡿⠉⠻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡏⢸⣿⣿⠇⣼⣿⣿⣿⣿⠋⣠⣾⣷⡄⠙⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠀⣿⣿⡟⢠⣿⣿⣿⡟⢁⣼⣿⣿⠏⣠⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣶⣤⣬⣁⣾⣿⣿⠏⣠⣿⣿⡿⢁⣴⣿⣿⣿⡿⠋⠹⣿⣿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠿⠿⠿⠟⠛⠛⠛⠻⠿⠿⢿⣿⣿⣿⣿⣿⣿⣿⣦⣌⠙⠋⣠⣾⣿⣿⠟⢋⣴⣿⣷⡈⠻⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠿⠛⠋⠉⠀⠀⠀⠀⢀⣀⣀⣀⣀⣀⣀⠀⠀⠀⠀⠈⠙⠛⠿⣿⣿⣿⣿⣿⣿⣿⣿⠟⢁⣴⣿⣿⡿⠋⣠⣾⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠟⠉⠀⠀⢀⣠⣴⣶⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣶⣦⣄⡀⠀⠀⠉⠻⢿⣿⣿⣿⣅⠰⣿⣿⠿⢋⣠⣾⡿⠿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠟⠉⠀⠀⣀⣴⣾⣿⡿⠋⢀⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡉⠓⢦⣀⠀⠀⠉⠻⣿⣿⣦⡈⢁⣴⡿⠛⣁⣴⣦⡈⢿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠟⠁⠀⢀⣴⣾⣿⣿⣿⡟⠁⢠⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠏⠙⠟⠛⣂⠀⠙⣷⣦⡀⠀⠈⠻⣿⣿⣿⣅⠰⣾⣿⣿⠿⠃⣀⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡟⠁⠀⢀⣴⣿⣿⣿⣿⣿⠏⠀⣠⣿⣿⣿⡟⠛⣿⣿⣿⣿⣿⣿⣿⣿⣶⣶⣶⠀⠘⣿⣿⣷⡀⠈⠻⣿⣦⡀⠀⠈⠻⣿⣿⣦⠘⢋⣠⣴⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⠋⠀⠀⣰⣿⣿⣿⣿⣿⣿⡈⠀⢠⣿⠏⢹⣿⡇⠀⣿⣿⣿⣿⣿⣿⣿⣿⠿⢿⣿⠀⠀⢿⣿⣿⣷⡀⠀⠙⣿⣿⣦⡀⠀⠙⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⠃⠀⢀⣾⣿⣙⠛⠿⣿⣿⡿⠀⠀⢸⡏⠀⣸⣿⡇⠀⢹⣿⣿⣿⣿⣿⣿⣿⠀⢸⣿⡇⠀⠀⠹⣿⣿⣷⠀⠀⠘⠟⠛⣁⡀⠀⠘⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⠇⠀⠀⠊⠀⣿⣿⣿⣶⣿⣿⠃⠀⡀⢸⠁⠀⣿⣿⠁⠀⢸⡇⣿⣿⣿⣿⣿⣿⠀⢸⣿⠃⠀⡄⠀⠙⣋⣉⡀⠀⠀⠸⣿⣿⣿⡄⠀⠘⠿⣿⣿⣿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⡿⠀⠀⠀⠀⣸⣿⣿⣿⣿⣿⡟⠀⢠⢳⠃⠀⠀⣶⡾⠀⠀⠈⠀⢨⣭⣥⣤⣤⡤⠀⠐⠐⠀⠀⣿⡄⠀⠘⣿⡇⠀⠀⠀⢻⣿⣿⣿⣦⡀⠀⠈⠛⠿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⡇⠀⠀⠀⣰⣿⣿⣿⣿⣿⣿⡇⠀⢸⠃⠀⠀⠀⠉⠁⠀⠀⡀⠀⢸⣿⣿⣿⣿⡇⠀⣠⡄⠀⠀⠀⠉⠀⠀⠘⡇⠀⠀⠀⠘⣿⣿⣿⡏⠈⢷⣤⡀⠀⠀⠉⠙⠛⠛⠿
⣿⣿⣿⣿⡿⠛⠁⠀⠀⡔⢻⣿⣿⣿⣿⣿⣿⠀⠀⠆⠀⣰⡆⠀⠀⠀⠀⠀⠃⠀⣼⣿⣿⣿⡿⠀⢀⡿⠀⠀⣠⣿⣿⣿⣆⠀⠀⠀⣸⡀⠀⢻⣿⣿⣷⡀⠀⠈⠉⠉⠀⠀⠀⠀⠀⢀
⠋⠉⠉⠀⠀⠀⠀⠴⠋⠀⠸⣿⣿⣿⣿⣿⡿⠀⠀⠀⠠⠋⣠⡀⠀⣠⠀⠀⠀⠀⠉⠉⠉⠉⠁⠀⠀⠀⣀⠔⠛⠉⢹⣿⣿⠄⠀⠀⠉⠇⠀⠈⢿⣿⣿⣇⠀⠀⠀⢠⣤⣤⣤⣶⣾⣿
⣄⠀⠀⠀⠀⠀⠀⢀⡀⠀⣴⣿⡟⣿⣿⣿⡇⠀⠀⠀⠀⠾⠿⠿⠾⣿⣿⣶⣶⣶⣶⣶⣶⣶⣾⣿⣿⣿⣇⡠⠔⠚⠉⠀⠀⠀⣀⣠⣴⡄⠀⢠⠸⠟⢛⣿⠀⠀⠀⠀⢿⣿⣿⣿⣿⣿
⣿⣿⣿⣶⣶⡆⠀⢸⠁⠀⣿⣿⡇⢹⣿⣿⡇⠀⠀⢠⣀⣀⣀⣀⠀⠀⠀⠀⠈⠙⢻⣿⣿⣿⣿⣿⣿⡟⠁⠀⠀⠀⠀⠐⠚⠛⠻⠿⢿⡇⠀⣸⡀⡇⢸⣿⡆⠀⠀⠀⢸⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⠁⠀⢸⠀⠀⣿⣿⣇⠘⣿⣿⡇⠀⠀⣿⡿⠿⠛⠛⠉⠁⠀⣀⣠⣤⣾⣿⣿⣿⣿⣿⣿⣿⣶⣶⣶⣦⣤⡤⠤⣤⣤⣤⣼⣇⠀⠹⡇⠀⠸⣿⡇⠀⠀⠀⠈⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⡄⠀⢸⡄⠀⢻⣿⣿⠀⢻⣿⡇⠀⢈⡁⠀⣀⣠⣤⣶⣶⣿⣿⣿⡟⠉⠁⠀⠀⠀⠀⠀⠉⠉⣿⣿⡿⢁⣴⣾⡟⢻⣿⠛⣿⡆⠀⠙⠀⢸⣿⡇⠀⠀⠀⠀⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⡇⠀⠸⡇⠀⢸⣿⣿⠀⠘⣿⣷⠀⠈⣿⣿⡿⠿⣿⡦⠘⣿⣿⣿⡇⠀⢸⣿⣿⣿⣿⡿⠀⢰⣿⣿⣇⠸⣿⣿⣧⣤⣧⣤⣿⡿⠀⠀⠀⢸⣿⠃⠀⡄⠀⢀⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣇⠀⠀⠇⠀⠀⣿⣿⠀⠀⠹⣿⡀⠀⢿⣿⣇⣠⣿⣤⠀⣼⣿⣿⡇⠀⢸⣿⣿⣿⣿⡇⠀⢸⣿⣿⣿⣦⣈⠙⠻⢿⣿⡿⠋⠀⢀⠎⠁⣾⣿⠀⠀⠁⠀⢸⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⡄⠀⠀⠀⠀⠸⣿⡀⡆⠀⠹⡇⠀⠘⠿⣿⣿⣋⣡⣾⣿⣿⣿⣇⠀⢸⣿⣿⣿⣿⠀⠀⣿⣿⣿⣿⣿⣿⡿⠗⠂⠁⠀⠀⢰⡿⠀⠀⣿⠇⠀⠀⠀⢀⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣷⡄⠀⠀⠀⠀⠹⡇⢰⣄⠀⠙⠀⠀⠀⠀⠉⠙⠛⠿⠿⠿⠿⣿⠀⠈⣿⣿⣿⠇⠀⠰⠿⠛⠛⠉⠁⠀⠀⠀⣀⣤⡆⠀⠘⠃⠀⠀⠏⠀⠀⣤⣤⣿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣶⣤⣦⠀⠀⠙⠈⣿⡄⠀⠀⠀⠀⢢⣤⣄⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣀⣠⣤⣤⣶⣾⣿⣿⣿⠃⠀⠀⠀⠀⠀⠀⠀⣼⣿⣿⣿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⡄⠀⠀⠻⡇⠀⠀⠀⠀⠈⢻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣦⣀⣠⣄⠀⢀⣴⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣦⡀⠀⠀⠀⠀⢳⣦⣤⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣤⣤⣤⣼⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
"
